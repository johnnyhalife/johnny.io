--- 
layout: post
title: How does TDD helps on programming decoupled components
published: true
meta: {}

tags: []

type: post
status: publish
---
<p>Last week I was posting about <a href="http://www.skyscrapr.net/blogs/solution/archive/2007/02/12/739.aspx">TDD and CAB</a> and <a href="http://www.skyscrapr.net/blogs/solution/archive/2007/02/13/749.aspx">How to write MVP using TDD.</a> This time I'll focus on <em>How does TDD helps on programming decoupled components?.</em> I want to thank <a href="http://www.skyscrapr.net/user/Profile.aspx?UserID=3376">Gabriel Gonzales</a> who gave me the idea commenting on this <a href="http://www.skyscrapr.net/blogs/solution/archive/2007/02/12/739.aspx">other post.</a></p>  <p>Let's think about it in terms of a sample:</p>  <p>Suppose that I have Component (A) that uses the Component (B). I'm the developer in charge of the Component (A). The architect of my project has come with a fully detailed list of requirements for Component (A) including interactions with Component (B).</p>  <p> So if I&#8217;m doing TDD, <strong>I&#8217;ll try to map a requirement to a test</strong>. Since the requirement is specified for Component (A) the test also should be written on the same way. To write the test in a way that it's accurated I&#8217;ve to be sure that once I implement the code for Component (A) the test will pass. What happens if Component B has a problem or it is wrong implemented. Is my code as bad as Component B since it doesn&#8217;t pass the test? How can I ensure that I&#8217;m really testing what I&#8217;ve written? The problem that we're facing is depicted below.</p>  <p><img alt="Bad testing surface" src="http://farm1.static.flickr.com/152/397365389_dad1337115.jpg?v=0" /></p>  <p>To provide an answer to the questions above I&#8217;ll introduce you a concept: <a href="http://en.wikipedia.org/wiki/Interface_based_programming">Interface Based Programming.</a></p>  <p>How does Interface Based Programming helps in this case?   <br />Let&#8217;s think what happens if we create an interface for Component (B) <em>[IComponentB]</em><strong> </strong>that has the methods and properties that it needs to interact with Component (A). After doing this, I can write the code of Component A to be based on <em>IComponentB</em> instead of the concrete Componet B object. Now what I&#8217;ve got is a dependency to an interface instead of to a concrete object.&#160; The picture below displays the change that we've introduced. </p>  <p><img alt="Introducing the interface" src="http://farm1.static.flickr.com/130/397365390_74cdb1ea8a.jpg?v=0" /></p>  <p>So what? For testing porpoises I can create a new object called MockComponentB that implements the interface IComponentB. When I&#8217;m doing the test case I can pass this object to be used instead of concrete Component B. With this way of working we&#8217;re introducing another concept that is called <a href="http://en.wikipedia.org/wiki/Inversion_of_control">Inversion of Control</a>. With <a href="http://en.wikipedia.org/wiki/Mock_object">Mock Objects</a> (that we&#8217;ve created for testing propoises) and the usage of IoC pattern we&#8217;ve successfuly decoupled the Component A from Component B. Since a Mock Object is a mimic object (for more info: <a href="http://en.wikipedia.org/wiki/Mock_object">http://en.wikipedia.org/wiki/Mock_object</a>), the new testing surface that we've is depicted below.</p>  <p><img alt="Good testing surface" src="http://farm1.static.flickr.com/139/397365393_ffc33b8d62.jpg?v=0" /></p>  <p>As summary we can say: </p>  <ul>   <li>Once we introduced the Mock and the IoC pattern we&#8217;ve decoupled the Component A from Component B </li>    <li>The surface of our test will have an accuracy of 100% of what we&#8217;re testing is really Component A. </li>    <li>Working with the idea of minimizing the test surface leaded us to decouple our componets. </li>    <li>Working in this way will lead us to have more decoupled component that takes our software to a modular approach where each component has an specific role or responsibility and also it could be exchanged with a new one or better one.</li> </ul>  <p>I hope this sample and this post helps you understanding how TDD will help you on programming decoupled components. One thing to have in mind is that making an abuse (for instance having a component for each method of the class or things like that) will take you from decoupling to over engineering. </p>  <p>Questions, feedback and comments are always welcomed. </p>  <blockquote>   <p><em>&#8220;This post is in memory of my grandfather who taught me how to do the walk of life &#8220;</em></p> </blockquote>  <p>thanks,   <br />~johnny</p>
